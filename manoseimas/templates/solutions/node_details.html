{% extends "sboard/node_details.html" %}
{% load i18n %}
{% load sboard %}

{% block node_body %}
  <div class="solution-body">
    {{ node.render_body }}
  </div>

    <div class="compat-preview" id="result"></div>
  <div class="btn-toolbar answers">
    <div class="btn-group position-buttons" data-toggle="buttons-radio">
      {% for value, label in buttons %}
      <button class="btn{% if value == position %} active{% endif %}"
              data-value="{{ value }}">
        {{ label|upper }}
      </button>
      {% endfor %}
    </div>
  </div>

  <table id="argumentai" class="positive-negative">
    <tbody>
      <tr>
        <td class="positive-header">
          <h2>{% trans "UŽ" %}</h2>
        </td>
        <td class="negative-header">
          <h2>{% trans "PRIEŠ" %}</h2>
        </td>
      </tr>
      {% for aye_against in arguments %}
      <tr>
        {% for argument in aye_against %}
        <td>
          {% if argument %}
          <h2><a href="{% nodeurl argument %}">{{ argument.issue.ref.title }}</a></h2>
          <p>{{ argument.summary }} <a class="more" href="{% nodeurl argument %}">Daugiau</a></p>
          {% if argument.counter_arguments %}
          <a class="counter-arguments-toggle" data-toggle="collapse" data-target="#{{ argument.slug }}">Kontr-argumentai <span class="caret"></span></a>
          <ul id="{{ argument.slug }}" class="inline counter-arguments collapse">
            {% for counter_argument in argument.counter_arguments %}
            <li>{{ counter_argument.summary }} <a class="more" href="{% nodeurl counter_argument %}">Daugiau</a></li>
            {% endfor %}
          </ul>
          {% endif %}
          {% endif %}
        </td>
        {% endfor %}
      </tr>
      {% endfor %}

      {% nodepermission node 'create' as can_create %}
      {% if can_create %}
      <tr class="actions">
        <td><a href="{% nodeurl node 'sprendzia' %}">{% trans "Pasiūlyk savo" %}</a></td>
        <td><a href="{% nodeurl node 'sukelia' %}">{% trans "Pasiūlyk savo" %}</a></td>
      </tr>
      {% endif %}
    </tbody>
  </table>
{% endblock %}

{% block inlinejs %}
<script type="text/javascript">

$(function() {
  $(".position-buttons > button").click(function() {
    var node = "{{ node.key }}";
    var position = $(this).attr('data-value');
    var url = "/testas/submit-position/";
    manoSeimas.submitPosition(url, node, position, function(result) {
      $("#result").html(result).show();
    });
  });
});
</script>
{% endblock %}

{% block additional_sidebar %}
{% include "partials/return_to_test.html" %}
{% endblock %}
